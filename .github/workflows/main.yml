name: Local Docker Compose Test

on:
  push:
    branches:
      - master   # или main, если у тебя ветка main

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Set up Docker Compose
        run: |
          sudo apt-get update
          sudo apt-get install docker-compose -y

      - name: Run docker-compose up
        run: |
          docker-compose up -d --build
          # если нужен лог, можно добавить:
          docker-compose ps
          docker-compose logs

      - name: Run tests (optional)
        run: |
          # сюда пиши команды для тестов, например:
          # docker-compose exec backend npm test
          echo "No tests specified"

      - name: Shutdown
        run: |
          docker-compose down
