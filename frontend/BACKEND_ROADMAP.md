# Дорожная карта разработки бэкенда

Этот документ представляет собой высокоуровневый план по созданию и запуску серверной части для платформы "ProDvor", заменяя текущие моковые данные и прототипные решения на полноценные продакшен-системы.

## Фаза 1: Фундаментальная Инфраструктура (Завершено)
-   **Цель:** Создать безопасную и масштабируемую основу для всего приложения.
-   **Статус:** **Выполнено.**
-   **Ключевые задачи:**
    -   [x] **Настройка СУБД:** Развернуты и настроены кластеры PostgreSQL для основного приложения и для Keycloak.
    -   [x] **Схема данных:** Разработана базовая схема данных с помощью Prisma ORM. Настроены миграции.
    -   [x] **Identity Provider:** Настроен Keycloak для будущего управления пользователями и аутентификацией.
    -   [x] **API Gateway:** Настроен Kong для будущей маршрутизации и защиты эндпоинтов.
    -   [x] **Брокеры сообщений:** Развернуты и сконфигурированы **Apache Kafka** и **RabbitMQ** для асинхронного взаимодействия.

## Фаза 2: Полное "оживление" API (Завершено)
-   **Цель:** Полностью искоренить все моковые (тестовые) данные из фронтенда и заменить их на реальные API-вызовы.
-   **Статус:** **Выполнено.**
-   **Ключевые задачи:**
    -   [x] **Разработка CRUD-эндпоинтов:** Реализованы все необходимые REST API-эндпоинты для сущностей: `Users`, `Teams`, `Matches`, `Tournaments`.
    -   [x] **Замена моков на фронтенде:** Все вызовы моковых данных (`src/shared/lib/mock-data/*`) заменены на реальные API-запросы к бэкенду.
    -   [x] **Перенос AI-логики:** Все вызовы к Genkit-флоу инкапсулированы на бэкенде и доступны фронтенду через защищенные эндпоинты.

## Фаза 3: Внедрение асинхронных и Real-time систем
-   **Цель:** Интегрировать Kafka и RabbitMQ в бизнес-логику для реализации чата, уведомлений и других асинхронных задач.
-   **Статус:** **В процессе.**
-   **Ключевые задачи:**
    1.  **Интеграция Kafka для чата:**
        -   Создать `chat-service`, который будет использовать Kafka для обмена сообщениями.
        -   Реализовать WebSocket API на бэкенде для подключения фронтенда к чатам.
        -   Интегрировать WebSocket-клиент на фронтенде.
    2.  **Интеграция RabbitMQ для уведомлений:**
        -   Создать `notification-service`, который будет слушать очереди RabbitMQ.
        -   Реализовать логику, при которой другие сервисы (например, `user-service`) при возникновении событий (новый запрос в друзья) отправляют сообщения в RabbitMQ.
        -   Настроить отправку push-уведомлений и/или email через `notification-service`.

## Фаза 4: Внедрение Production-аутентификации
-   **Цель:** Заменить текущую прототипную систему аутентификации на безопасную и масштабируемую связку Keycloak + Kong.
-   **Статус:** **Предстоит.**
-   **Ключевые задачи:**
    1.  Настроить OIDC-плагин в Kong для валидации JWT-токенов от Keycloak.
    2.  Переписать логику входа/регистрации на фронтенде для работы со стандартным OIDC-флоу.
    3.  Обеспечить безопасную передачу токенов при каждом API-запросе и управление сессией.

## Фаза 5: Финальная полировка и зачистка
-   **Цель:** Подготовить кодовую базу к долгосрочной поддержке и запуску.
-   **Статус:** **Предстоит.**
-   **Ключевые задачи:**
    1.  **Тестирование:** Покрыть критически важную бизнес-логику юнит- и интеграционными тестами.
    2.  **Удаление мертвого кода:** Полностью удалить все моковые данные и неиспользуемые файлы.
    3.  **CI/CD:** Оптимизировать пайплайны для автоматической сборки и развертывания.
    4.  **Финальная документация:** Обновить все документы, чтобы они на 100% соответствовали финальному продукту.
    5.  **Приложение готово!**
